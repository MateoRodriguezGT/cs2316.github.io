<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title></title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/gt.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="csv-files" class="slide level1">
<h1>CSV Files</h1>
</section>
<section id="text-file-io" class="slide level1">
<h1>Text File IO</h1>
<ul>
<li>File IO is done in Python with the built-in <code>File</code> object which is returned by the built-in <code>open</code> function</li>
<li>Use the <code>'w'</code> open mode for writing</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python
<span class="op">&gt;&gt;&gt;</span> f <span class="op">=</span> <span class="bu">open</span>(<span class="st">&quot;hello.txt&quot;</span>,’w’) <span class="co"># open for writing, create if necessary</span>
<span class="op">&gt;&gt;&gt;</span> f.write(<span class="st">&quot;Hello, file!</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="co"># write string to file; notice \n ending</span>
<span class="op">&gt;&gt;&gt;</span> f.close()                 <span class="co"># close file, causing it to write to disk</span>
<span class="op">&gt;&gt;&gt;</span> exit()
$ cat hello.txt
Hello, <span class="bu">file</span><span class="op">!</span></code></pre></div>
<p>Use the ’r’ open mode for reading</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python
<span class="op">&gt;&gt;&gt;</span> f <span class="op">=</span> <span class="bu">open</span>(<span class="st">&quot;hello.txt&quot;</span>, <span class="st">&quot;r&quot;</span>) <span class="co"># open for reading in text mode</span>
<span class="op">&gt;&gt;&gt;</span> contents <span class="op">=</span> f.read()
<span class="co"># slurp the whole file into memory</span>
<span class="op">&gt;&gt;&gt;</span> contents
’Hello, <span class="bu">file</span><span class="op">!\</span>n’
<span class="op">&gt;&gt;&gt;</span> exit()</code></pre></div>
</section>
<section id="reading-lines-from-text-files" class="slide level1">
<h1>Reading Lines from Text Files</h1>
<ul>
<li>Text files often have data split into lines</li>
<li>the <code>readlines()</code> function reads all lines into memory as a list</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> f <span class="op">=</span> <span class="bu">open</span>(’lines.txt’, ’r’)
<span class="op">&gt;&gt;&gt;</span> f.readlines()
[’line <span class="dv">1</span><span class="op">\</span>n’, ’line <span class="dv">2</span><span class="op">\</span>n’, ’line <span class="dv">3</span><span class="op">\</span>n’]</code></pre></div>
</section>
<section id="one-line-at-a-time" class="slide level1">
<h1>One Line at a Time</h1>
<ul>
<li><code>readline()</code> reads one line at a time, returns empty string when fully read</li>
<li>re-open file or use seek() to go back to beginning of file</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> f <span class="op">=</span> <span class="bu">open</span>(’lines.txt’, ’r’)
<span class="op">&gt;&gt;&gt;</span> f.readline()
’line <span class="dv">1</span><span class="op">\</span>n’
<span class="op">&gt;&gt;&gt;</span> f.readline()
’line <span class="dv">2</span><span class="op">\</span>n’
<span class="op">&gt;&gt;&gt;</span> f.readline()
’line <span class="dv">3</span><span class="op">\</span>n’
<span class="op">&gt;&gt;&gt;</span> f.readline()
<span class="co">&#39;&#39;</span>
<span class="op">&gt;&gt;&gt;</span> f.seek(<span class="dv">0</span>)
<span class="op">&gt;&gt;&gt;</span> f.readline()
’line <span class="dv">1</span><span class="op">\</span>n’</code></pre></div>
</section>
<section id="processing-all-lines-in-a-text-file" class="slide level1">
<h1>Processing All Lines in a Text File</h1>
<p>Could use readlines() and iterate through list it returns</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> f <span class="op">=</span> <span class="bu">open</span>(’lines.txt’, ’r’)
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> f.readlines():
...     <span class="bu">print</span> line
...
line <span class="dv">1</span>
line <span class="dv">2</span>
line <span class="dv">3</span></code></pre></div>
<p>Better to take advantage of fact <code>File</code> is <code>Iterable</code></p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> <span class="bu">open</span>(’lines.txt’, ’r’):
...     <span class="bu">print</span> line
...
line <span class="dv">1</span>
line <span class="dv">2</span>
line <span class="dv">3</span></code></pre></div>
</section>
<section id="files-are-buffered" class="slide level1">
<h1>Files are Buffered</h1>
<p>Try a little experiment: lauch a Python shell, create open a new file named bar, and write something to it.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> bar <span class="op">=</span> <span class="bu">open</span>(<span class="st">&quot;bar&quot;</span>, ’w’)
<span class="op">&gt;&gt;&gt;</span> bar.write(<span class="st">&quot;last call!&quot;</span>)
<span class="dv">10</span></code></pre></div>
<p>At this point, open another command shell or use your graphical file explorer to view the contents of the bar file. It’s empty. Now go back to your Python shell and do:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> bar.close()</code></pre></div>
<p>Now view the contents of the <code>bar</code> file again. It has the text from the previous <code>write()</code> call. Files are buffered, and the buffer isn’t (guaranteed to be) flushed to disk until the file object is closed or the <code>File</code> Object goes out of scope or the program terminates (gracefully).</p>
</section>
<section id="context-management-with-with" class="slide level1">
<h1>Context Management with <code>with</code></h1>
<p>Python has context managers to close resources automatically. A context manager has the form</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="cf">with</span> <span class="op">&lt;</span>expression<span class="op">&gt;</span> <span class="im">as</span> <span class="op">&lt;</span>variable<span class="op">&gt;</span>:
    <span class="op">&lt;</span>block<span class="op">&gt;</span></code></pre></div>
<p>which is equivalent to</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&lt;</span>variable<span class="op">&gt;</span> <span class="op">=</span> <span class="op">&lt;</span>expression<span class="op">&gt;</span>
<span class="op">&lt;</span>block<span class="op">&gt;</span>
<span class="op">&lt;</span>variable<span class="op">&gt;</span>.close()`</code></pre></div>
<p>For example, the previous bar example is:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(’bar’, ’w’) <span class="im">as</span> bar:
...     bar.write(’last call<span class="op">!</span>’)
...</code></pre></div>
<p>And the file is closed and flushed to disk automatically after the block under the with statement finishes.</p>
</section>
<section id="comma-separated-values-files" class="slide level1">
<h1>&quot;Comma&quot;-Separated Values Files</h1>
<p>Say we have data in a comma-separated values file</p>
<pre><code>$ cat capitals.dat # could be .dat, .csv, or anything
Japan,Tokyo
France,Paris
Germany,Berlin
U.S.A.,Washington, D.C</code></pre>
<p>Can use line-by-line file reading with the split() function we saw earlier to process comma-separated value files</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python">$ python
<span class="op">&gt;&gt;&gt;</span> capitals <span class="op">=</span> {} <span class="co"># initialize a dictionary to hold our capitals data</span>
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> <span class="bu">open</span>(’capitals.dat’, ’r’): <span class="co"># for each line in file</span>
...     k, v <span class="op">=</span> line.split(’,’)             <span class="co"># split into key and value</span>
...     capitals[k] <span class="op">=</span> v                    <span class="co"># add key:value to dict</span>
...
Traceback (most recent call last):
File <span class="st">&quot;&lt;stdin&gt;&quot;</span>, line <span class="dv">2</span>, <span class="op">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span>
<span class="pp">ValueError</span>: too many values to unpack</code></pre></div>
<p>Why didn’t it work?</p>
</section>
<section id="csv-separator-characters" class="slide level1">
<h1>CSV Separator Characters</h1>
<p>We can troubleshoot in the Python interpreter</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> <span class="bu">open</span>(’capitals.dat’, ’r’):
...     <span class="bu">print</span> line.split(’,’)
...
[’Japan’, ’Tokyo<span class="op">\</span>n’]
[’France’, ’Paris<span class="op">\</span>n’]
[’Germany’, ’Berlin<span class="op">\</span>n’]
[’U.S.A.’, ’Washington’, ’ D.C<span class="op">\</span>n’]</code></pre></div>
<p>There’s a comma in Washington, D.C. that was taken as a separator So let’s change the capitals.dat file to use semicolons as the separators</p>
<pre class="sh"><code>$ cat capitals.dat
Japan;Tokyo
France;Paris
Germany;Berlin
U.S.A.;Washington, D.C</code></pre>
</section>
<section id="csv-files-in-practice" class="slide level1">
<h1>CSV Files in Practice</h1>
<p>Now our capitals.dat file is readable as a &quot;comma&quot;-separated values file</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> capitals <span class="op">=</span> {}
<span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> <span class="bu">open</span>(’capitals.dat’, ’r’):
...     k, v <span class="op">=</span> line.split(’<span class="op">;</span>’)
...     capitals[k] <span class="op">=</span> v
...
<span class="op">&gt;&gt;&gt;</span> capitals
{’Japan’: ’ Tokyo<span class="op">\</span>n’, ’U.S.A.’: ’ Washington, D.C<span class="op">\</span>n’, ’Germany’: ’
Berlin<span class="op">\</span>n’, ’France’: ’ Paris<span class="op">\</span>n’}</code></pre></div>
<ul>
<li>But the values have leading whitespace and trailing ’’ characters from the data file</li>
</ul>
</section>
<section id="manually-cleaning-csv-lines" class="slide level1">
<h1>Manually Cleaning CSV Lines</h1>
<ul>
<li>We can make our code more robust with strip(), which removes leading and trailing whitespace and non-printing chars</li>
</ul>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> line <span class="op">in</span> <span class="bu">open</span>(’capitals.dat’, ’r’):
...     k, v <span class="op">=</span> line.split(’<span class="op">;</span>’)
...     capitals[k.strip()] <span class="op">=</span> v.strip()
...
<span class="op">&gt;&gt;&gt;</span> capitals
{’Japan’: ’Tokyo’, ’U.S.A.’: ’Washington, D.C’, ’Germany’: ’Berlin’,
’France’: ’Paris’}</code></pre></div>
<p>But we don't need to go to this trouble ...</p>
</section>
<section id="the-csv-module" class="slide level1">
<h1>The <code>csv</code> Module</h1>
<p>The best way to process CSV files is with the csv module.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> csv
<span class="op">&gt;&gt;&gt;</span> scripters <span class="op">=</span> [
...     [’Perl’, ’Larry Wall’],
...     [’Python’, ’Guido Van Rossum’],
...     [’Ruby’, ’Yukihiro Matsumoto’]
... ]
<span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(’scripters’, ’wt’) <span class="im">as</span> fout:
...     csvout <span class="op">=</span> csv.writer(fout)
...     csvout.writerows(scripters)
...
<span class="op">&gt;&gt;&gt;</span> <span class="op">^</span>D
$ cat scripters
Perl,Larry Wall
Python,Guido Van Rossum
Ruby,Yukihiro Matsumoto</code></pre></div>
<ul>
<li>The with statement creates a context manager</li>
<li>After the with block ends, the file is automatically closed</li>
</ul>
</section>
<section id="reading-csv-files" class="slide level1">
<h1>Reading CSV Files</h1>
<p>We can read our scripters file with</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> csv
<span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(’scripters’, ’r’) <span class="im">as</span> fin:
...     csvin <span class="op">=</span> csv.reader(fin)
...     scripters <span class="op">=</span> [line <span class="cf">for</span> line <span class="op">in</span> csvin]
...
<span class="op">&gt;&gt;&gt;</span> scripters
[[’Perl’, ’Larry Wall’], [’Python’, ’Guido Van Rossum’], [’Ruby’,
’Yukihiro Matsumoto’]]
<span class="op">&gt;&gt;&gt;</span></code></pre></div>
</section>
<section id="column-headers-in-csv-files" class="slide level1">
<h1>Column Headers in CSV Files</h1>
<p>Use a DictReader to store the records from the CSV file in a dict.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="im">import</span> csv
<span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(’scripters’, ’r’) <span class="im">as</span> fin:
...     csvin <span class="op">=</span> csv.DictReader(fin, fieldnames<span class="op">=</span>[’langauge’, ’creator’])
...     scripters <span class="op">=</span> [line <span class="cf">for</span> line <span class="op">in</span> csvin]
...
<span class="op">&gt;&gt;&gt;</span> scripters
[{’creator’: ’Larry Wall’, ’langauge’: ’Perl’}, {’creator’: ’Guido Van
Rossum’, ’langauge’: ’Python’}, {’creator’: ’Yukihiro Matsumoto’,
’langauge’: ’Ruby’}]</code></pre></div>
</section>
<section id="writing-dicts-to-csv-files" class="slide level1">
<h1>Writing Dicts to CSV Files</h1>
<p>And we can use a DictWriter to write a CSV file with a header line.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="op">&gt;&gt;&gt;</span> <span class="cf">with</span> <span class="bu">open</span>(’scripters’, ’w’) <span class="im">as</span> fout:
...     csvout <span class="op">=</span> csv.DictWriter(fout, fieldnames<span class="op">=</span>[’langauge’,
’creator’])
...     csvout.writeheader()
...     csvout.writerows(scripters)
...
<span class="op">&gt;&gt;&gt;</span> <span class="op">^</span>D
$ cat scripters
langauge,creator
Perl,Larry Wall
Python,Guido Van Rossum
Ruby,Yukihiro Matsumoto</code></pre></div>
</section>
<section id="csv-details" class="slide level1">
<h1>CSV Details</h1>
<p>CSV files can be complex.</p>
<ul>
<li>Different delimiters can be used.</li>
<li>Delimiter characters can appear in fields.</li>
<li>Fields can be surrounded with &quot;quotes&quot;.</li>
<li>Different operating systems may use different line endings.</li>
</ul>
<p>The CSV module handles all of these issues for you. Read the <a href="">CSV module documentation</a> to become familiar with its capabilities.</p>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: 'c/t',

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
